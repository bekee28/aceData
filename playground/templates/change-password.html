{% load static %}
<!DOCTYPE html>
<html lang="en" dir="">
  <head>
    <!-- Required Meta Tags Always Come First -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Title -->
    <title>Reset Password | Space - Multipurpose Responsive Template</title>

    <!-- Favicon -->
    <link rel="shortcut icon" href="{% static 'playground/assets/favicon.ico' %}">

    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- CSS Implementing Plugins -->
    <link rel="stylesheet" href="{% static 'playground/assets/vendor/bootstrap-icons/font/bootstrap-icons.css' %}">
    <link rel="stylesheet" href="{% static 'playground/assets/vendor/hs-mega-menu/dist/hs-mega-menu.min.css' %}">

    <!-- CSS Space Template -->
    <link rel="stylesheet" href="{% static 'playground/assets/css/theme.min.css' %}">

    <style>
      .invalid-feedback {
          color: red;
      }

      .messages {
          color: orangered;
      }
  </style>

  </head>

  <body>
    {% include "header.html" %}

    <!-- ========== MAIN CONTENT ========== -->
    <main id="content" role="main">
      <!-- Content -->
      <div class="bg-soft-primary-light">
        <div class="container content-space-1 content-space-t-md-3">
          <div class="mx-auto" style="max-width: 30rem;">
            <!-- Card -->
            <div class="card card-lg zi-2">
              <!-- Header -->
              <div class="card-header text-center">
                <h4 class="card-title">Change Password?</h4>
                <p class="card-text">Enter your new password</p>
              </div>
              <!-- End Header -->

              <!-- Card Body -->
              <div class="card-body">
                <form class="form-label" method="post" action="{% url 'change_password' %}">
                {% csrf_token %}
                  <!-- Form -->
                  <div class="mb-4">
                    <label class="form-label" for="old_password">Old Password</label>
                    <input type="password" class="form-control form-control-lg" name="old_password" id="old_password" placeholder="Enter your new password" aria-label="Enter your new password" required>
                    <div class="invalid-feedback d-block"></div>
                  </div>

                  <div class="mb-4">
                    <label class="form-label" for="changed_password">New Password</label>
                    <input type="password" class="form-control form-control-lg" name="changed_password" id="changed_password" placeholder="Enter your new password" aria-label="Enter your new password" required>
                  </div>
                  <!-- End Form -->

                  <div class="d-grid mb-4">
                    <button type="submit" class="btn btn-primary btn-lg">Submit</button>
                  </div>
                  {% if messages %}
                  <ul class="messages">
                    {% for message in messages %}
                    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
                <div class="invalid-feedback" id="passwordErrorChar">Password must be more than 8 characters</div>
                <div class="invalid-feedback" id="passwordErrorCommon">Password is too common</div>
                <div class="invalid-feedback" id="passwordErrorNumeric">Password can't be entirely numeric</div>
                  <div class="text-center">
                    <a class="btn btn-link" href="/login">
                      <i class="bi-chevron-left small me-1"></i> Back to log in
                    </a>
                  </div>
                </form>
              </div>
              <!-- End Card Body -->
            </div>
            <!-- End Card -->
          </div>
        </div>
      </div>
      <!-- End Content -->

      <!-- Shape -->
      <div class="shape-container">
        <div class="shape shape-bottom zi-1">
          <svg viewBox="0 0 3000 600" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M0 600V350.234L3000 0V600H0Z" fill="#fff"/>
          </svg>
        </div>
      </div>
      <!-- End Shape -->

      <!-- Clients -->
      <div class="container content-space-b-1 content-space-b-md-3">
        <div class="w-lg-65 text-center mx-lg-auto">
          <!-- Heading -->
          <div class="mb-4">
            <h5>Thousands of worldâ€™s leading companies trust Space</h5>
          </div>
          <!-- End Heading -->

          <div class="row">
            <div class="col text-center py-3">
              <img class="avatar avatar-lg avatar-4x3" src="{% static 'playground/assets/svg/brands/capsule-primary.svg' %}" alt="Logo">
            </div>
            <!-- End Col -->

            <div class="col text-center py-3">
              <img class="avatar avatar-lg avatar-4x3" src="{% static 'playground/assets/svg/brands/fitbit-primary.svg' %}" alt="Logo">
            </div>
            <!-- End Col -->

            <div class="col text-center py-3">
              <img class="avatar avatar-lg avatar-4x3" src="{% static 'playground/assets/svg/brands/forbes-primary.svg' %}" alt="Logo">
            </div>
            <!-- End Col -->

            <div class="col text-center py-3">
              <img class="avatar avatar-lg avatar-4x3" src="{% static 'playground/assets/svg/brands/mailchimp-primary.svg' %}" alt="Logo">
            </div>
            <!-- End Col -->

            <div class="col text-center py-3">
              <img class="avatar avatar-lg avatar-4x3" src="{% static 'playground/assets/svg/brands/layar-primary.svg' %}" alt="Logo">
            </div>
            <!-- End Col -->
          </div>
          <!-- End Row -->
        </div>
      </div>
      <!-- End Clients -->
    </main>
    <!-- ========== END MAIN CONTENT ========== -->

    {% include "footer.html" %}

    {% include "secondary.html" %}

    <!-- JS Global Compulsory  -->
    <script src="{% static 'playground/assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js' %}"></script>

    <!-- JS Implementing Plugins -->
    <script src="{% static 'playground/assets/vendor/hs-mega-menu/dist/hs-mega-menu.min.js' %}"></script>
    <script src="{% static 'playground/assets/vendor/hs-show-animation/dist/hs-show-animation.min.js' %}"></script>
    <script src="{% static 'playground/assets/vendor/hs-go-to/dist/hs-go-to.min.js' %}"></script>
    <script src="{% static 'playground/assets/vendor/hs-toggle-password/dist/js/hs-toggle-password.js' %}"></script>

    <!-- JS Space -->
    <script src="{% static 'playground/assets/js/theme.min.js' %}"></script>

    <script>
      // Function to perform password validation
      function validatePassword() {
        const changed_password = document.getElementById("changed_password").value;
        const passwordErrorChar = document.getElementById("passwordErrorChar");
        const passwordErrorNumeric = document.getElementById("passwordErrorNumeric");
        const passwordErrorCommon = document.getElementById("passwordErrorCommon");
    
        // Check password criteria
        const minLength = 8;
        const commonPasswords = ["123456", "password", "qwerty"]; // Add more if needed
        const numericPattern = /^\d+$/;
    
        if (changed_password.length < minLength) {
          passwordErrorChar.style.display = "block";
          return false;
        } else {
          passwordErrorChar.style.display = "none";
        }
    
        if (commonPasswords.includes(changed_password.toLowerCase())) {
          passwordErrorCommon.style.display = "block";
          return false;
        } else {
          passwordErrorCommon.style.display = "none";
        }
    
        if (numericPattern.test(changed_password)) {
          passwordErrorNumeric.style.display = "block";
          return false;
        } else {
          passwordErrorNumeric.style.display = "none";
        }
    
        return true;
      }
    
      // Add event listener to the form
      document.querySelector(".form-label").addEventListener("submit", function (event) {
        if (!validatePassword()) {
          event.preventDefault(); // Prevent form submission
        }
      });
    </script>
  

    <!-- JS Plugins Init. -->
    <script>
      (function() {
        // INITIALIZATION OF MEGA MENU
        // =======================================================
        const megaMenu = new HSMegaMenu('.js-mega-menu', {
          desktop: {
            position: 'left'
          }
        })


        // INITIALIZATION OF SHOW ANIMATIONS
        // =======================================================
        new HSShowAnimation('.js-animation-link')


        // INITIALIZATION OF BOOTSTRAP VALIDATION
        // =======================================================
        HSBsValidation.init('.js-validate', {
          onSubmit: data => {
            data.event.preventDefault()
            alert('Submited')
          }
        })


        // INITIALIZATION OF GO TO
        // =======================================================
        new HSGoTo('.js-go-to')
      })()
    </script>
  </body>
</html>